<!DOCTYPE html>
<head>
    <link rel="stylesheet" href="styles/./mocking.css" />
    <link rel="stylesheet" href="styles/./sidebar.css" />
</head>
<body>
    <div class="sidebar">
        <a href="./index.html">Начало</a>
        <a href="./config.html">Конфигурация</a>
        <a href="./matchers.html">Проверка на съвпадения</a>
        <a class="active" href="./mocking.html">Мокинг</a>
        <a href="./resources.html">Ресурси</a>
    </div>
    <div class="header">
        <div class="innerMain">
     
            <h2 class="head">Мокинг</h2>
            <p class="noMarginBottom">
                Мокингът е операция, която позволява променя и мониторира върху предоставената функция или модул.
            </p>
            <p class="noMargin">
                Мокингът е предназначен за проверка на връзката между системата ни и достъпваните външни ресурси: 
            </p>
            <ul>
                    <li>Бази данни</li>
                    <li>Мрежово достъпни ресурси</li>
                    <li>Файлове</li>
            </ul>
            <p class="noMarginBottom">
                Мокинг функционалността също може да се използва за тестване на трудно достъпна или опакована логика
                Мокинг обектите , още наречени мок функции или "шпиони", са методи копия на предоставените функции или модули, но с гореспоменатите възможностти за промяна и наблюдение. 
            </p>
            <p >
                Всяка мок функция притежава подметод <b>mock</b>, който съдържа информация кога методът е извикан и с каква имплементация. 
            </p>
            <p >
                Ключови методи: 
            </p>
            <ul>
                <li class="descriptionTextLi">
                    <p>fn
                        <p class="descriptionPopupText noMarginBottom">Създава нов празен мокинг метод. При извикване на метода без предоставена имплементация ще бъде върната недефинирана стойност </p>
                        <pre class="descriptionPopupText">const myMock1 = jest.fn();</pre>
                        <pre class="descriptionPopupText">const a = new myMock1(); </pre>
                        <p class="descriptionPopupText noMarginBottom">Възможно е добавянето на имплементация по подразбиране чрез подаване на параметър към мок функцията </p>
                        <pre class="descriptionPopupText">const myMock1 = jest.fn(() => 42);</pre>
                    </p>
                <li class="descriptionTextLi">
                    <p>mock
                        <p class="descriptionPopupText">Подметод на всяка мок функция, съдържащ информация за имплементацията и извикването му </p>
                        <pre class="descriptionPopupText"> myMock.mock.instances </pre>
                    </p>
                </li>
                <li class="descriptionTextLi">
                    <p>bind
                        <p class="descriptionPopupText">Позволява на реален обект бъде превърнат в контекст на мокинг обект</p>
                        <pre class="descriptionPopupText"> const b = {}</pre>
                        <pre class="descriptionPopupText"> const mockObject = jest.fn()</pre>
                        <pre class="descriptionPopupText"> const s = mockObject.bind(b)</pre>
                    </p>
                </li>
                <li class="descriptionTextLi">
                    <p>spyOn
                        <p class="descriptionPopupText">Методът създава мок функция подобно на <b>fn</b>, но предоставя възможността за наблюдение над извикванията</p>
                        <pre class="descriptionPopupText"> // Нека имаме модул "player" с метод "start"</pre>
                        <pre class="descriptionPopupText"> const newSpy = jest.spyOn(player, 'start')</pre>
                    </p>
                </li>
            </ul>
            <h3>
                Видове Мокинг
            </h3>
            <p>
                Долуспоменатите методи могат да бъдат ползвани единствено върху мок функции. 
            </p>
           
            <ul>
                <li>
                    <h4>
                        Мокинг на функции
                    </h4>
                    <p class="noMarginBottom">
                        Мокингът на функции предоставя възможността да се промени имплементацията или  изходното състояние.
                    </p>
                    <p>
                        Изходното състояние на избрания метод може да се промени веднъж или изцяло. 
                        Възможна е конкатенация на методи за промяна на изходното състояние при всяко извикване на избрания метод. 
                    </p>
                    <p>
                        Често използвани методи за промяна на изход:
                    </p>
                    <ul>
                        <li class="descriptionTextLi">
                            <p>
                                mockReturnValueOnce
                            <p class="descriptionPopupText">Позицията на метода в конкатенацията дефинира на кое извикване ще бъде върната подадената стойност</p>
                            <pre class="descriptionPopupText">myMock.mockReturnValueOnce('x').mockReturnValue(true)</pre>
                            </p>
                        <li class="descriptionTextLi">
                            <p>mockReturnValue
                            <p class="descriptionPopupText">При всяко извикване метода ще бъде върната подадената стойност </p>
                            <pre class="descriptionPopupText"> myMock.mockReturnValue('Hello') </pre>
                            </p>
                        </li>
                    </ul>
                    <p class="noMarginBottom">
                        Методите "шпиони" могат да бъгат използвани в комбинация с методи за проверка на съвпаденията. Проверките на съвпадение спомагат за тестването на системни
                        логики при предефинирани изходни данни на вложените мок методи  
                    </p>
                </li>
                <li>
                    <h4>
                        Мокинг на модули
                    </h4>
                    <p class="noMarginBottom">
                        Мокинг функционалността също може да се използва за тестване на трудно достъпна или опакована логика.
                    </p>
                    <p>
                        Главният метод за създаване на методи "шпиони" е <b>mock</b>. Вградената функция позволява да се създаде копие на даден модул или негова част. 
                    </p>
                    <p>
                        Спомагателни методи:
                    </p>
                    <ul>
                        <li class="descriptionTextLi">
                            <p>
                                mockImplementationOnce
                            <p class="descriptionPopupText">Подобно на <b>mockReturnValueOnce</b>, този метод позволява да се промени имплементацията на определен модул</p>
                            <p class="descriptionPopupText">Позицията на метода в конкатенацията дефинира на кое извикване ще бъде изпълнена предоставената имплементация</p>
                            <pre class="descriptionPopupText">jest.mock('./method') // създаване на метод "шпионин"</pre>
                            <pre class="descriptionPopupText">const method = require('./method') // импортиране на модул </pre>
                            <pre class="descriptionPopupText">method.mockImplementationOnce(() => 42)</pre>
                            </p>
                        </li>
                        <li class="descriptionTextLi">
                            <p>mockImplementation
                            <p class="descriptionPopupText"> Позволява на потребителя да подмени имплементацията на метод от мокнат модул с предоставената имплементация</p>
                            <pre class="descriptionPopupText">jest.mock('./method') // създаване на метод "шпионин"</pre>
                            <pre class="descriptionPopupText">const method = require('./method') // импортиране на модул </pre>
                            <pre class="descriptionPopupText">method.mockImplementation(() => 42)</pre>
                            </p>

                        </li>
                    </ul>
                </li>

            </ul>
        </div>
    </div>
</body>